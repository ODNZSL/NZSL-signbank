{% load stylesheet %}
{% load bootstrap3 %}
{% load i18n %}
{% load static %}
{% load comments %}

<table class='table table-condensed'>
    <tr>
        <th>{% blocktrans %}Created:{% endblocktrans %}</th>
        <td id='created'>{% if gloss.created_at %}<span class="glyphicon glyphicon-time" aria-hidden="true"></span> <em>{{ gloss.created_at|date:'Y-m-d H:i' }}</em> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> {{ gloss.created_by.username }}{% endif %}</td>
    </tr>
    <tr>
        <th>{% blocktrans %}Updated:{% endblocktrans %}</th>
        <td id='updated'>{% if gloss.updated_at %}
            <span class="glyphicon glyphicon-time" aria-hidden="true"></span> <em>{{ gloss.updated_at|date:'Y-m-d H:i' }}</em> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> {{ gloss.updated_by.username }}
            {% if request.user.is_staff %}

            <hr style="border-top-color:#C0C0C0;margin-bottom:10px;">

            <div>
              <h4>{% blocktrans %}Change history for{% endblocktrans %} <strong>{{gloss}}</strong></h4>
            </div>
            <div>
              <table class='table table-condensed'>
                <tr>
                    <th>{% blocktrans %}User{% endblocktrans %}</th>
                    <th>{% blocktrans %}Time{% endblocktrans %}</th>
                    <th>{% blocktrans %}Field{% endblocktrans %}</th>
                    <th>{% blocktrans %}Old value{% endblocktrans %}</th>
                    <th>{% blocktrans %}New value{% endblocktrans %}</th>
                </tr>
                {% for revision_username,revision_time,revision_fieldname,revision_old,revision_new in revisions %}
                <tr>
                    {# User #}
                    <td>
                        {{ revision_username }}
                    </td>
                    {# Time - format: June 22, 2022, 4:06 p.m. #}
                    <td>
                        {{ revision_time|date:'F j, Y, g:i a' }}
                    </td>
                    {# Field #}
                    <td>
                        {{ revision_fieldname }}
                    </td>
                    {# Old value #}
                    <td>
                        {{ revision_old }}
                    </td>
                    {# New value #}
                    <td>
                        {{ revision_new }}
                    </td>
                </tr>
                {% endfor %}
              </table>
              {% comment %} <ul class="">
              {% for version in revisions %}
                  <li><a href="{% url 'admin:dictionary_gloss_revision' gloss.pk version.pk %}">
                      <span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                      {{version.revision.date_created|date:'Y-m-d H:i'}}
                      <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                      {{version.revision.user.username }}
                      {{version.revision.comment}} |
                      {% if version.data_added or version.data_removed %}{% blocktrans %}Gloss fields:{% endblocktrans %}{% endif %}
                      {% if version.data_added %}<span style="color:green;">+{{version.data_added}}</span>{% endif %}
                      {% if version.data_removed %}<span style="color:red;">-{{version.data_removed}}</span>{% endif %}
                      <br>
                      {% if version.translations_added or version.translations_removed %}{% blocktrans %}Translations:{% endblocktrans %}{% endif %}
                      {% if version.translations_added %}<span style="color:green;">{{version.translations_added}}</span>{% endif %}
                      {% if version.translations_removed %}<span style="color:red;">{{version.translations_removed}}</span>{% endif %}
                  </a></li>
              {% endfor %}
              </ul> {% endcomment %}
            </div>
            {% endif %} {# if request.user.is_staff #}
            {% endif %} {# if gloss.updated_at #}
        </td>
    </tr>
</table>

<hr style="border-top-color:#C0C0C0;margin-bottom:10px;">

{% get_comment_count for gloss as comment_count %}
<div id="gloss-comments">
    <h4>{% blocktrans %}Comments{% endblocktrans %} ({{comment_count}})</h4>
    <div class="well well-md">
    {% render_comment_list for gloss %}

    </div>
</div>
